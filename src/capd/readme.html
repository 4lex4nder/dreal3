<html>
<head>
<title>The CAPD Library Source Code Distribution</title>
<link rel=stylesheet type="text/css" href="../capd.css">
</head>
<body background="../tla/bk2.gif">

<h1>The CAPD Library Source Code Distribution</h1>

<p>This document describes several technical aspects
of the source code distribution of the CAPD library.
This library can be downloaded from the CAPD website at
<a href="http://capd.ii.uj.edu.pl/" target="_top">capd.ii.uj.edu.pl</a>
and is distributed under the terms of the
<a href="http://www.gnu.org/copyleft/gpl.html"
target="_top">GNU General Public License</a>.</p>

<p>This document is divided into the following sections:
<ul>
<li><a href="#SystemRequirements">System Requirements</a></li>
<li><a href="#CompilationInstructions">Compilation Instructions</a></li>
<li><a href="#DirectoryLayout">Directory Layout</a></li>
<li><a href="#LibraryModules">Library Modules</a></li>
<li><a href="#MakeFiles">Make Files</a></li>
<li><a href="#ConfigurationFiles">Configuration Files</a></li>
<li><a href="#ProgramsthatUsetheLibrary">Programs that Use the Library</a></li>
<li><a href="#HowtoCompileaProgramthatUsestheLibrary">How to Compile a Program that Uses the Library</a></li>
</ul>
</p>

<p>The initial version of this document was prepared by
<a href="http://www.pawelpilarczyk.com/" target="_top">Pawel Pilarczyk</a>
on April 3-4, 2005.</p>

<p>Permission is granted to copy, distribute and/or modify this document
under the terms of the <a href="http://www.gnu.org/copyleft/fdl.html"
target="_top">GNU Free Documentation License</a>.</p>

<hr>

<a name="SystemRequirements"></a>
<h2>System Requirements</h2>

<p>The system configurations for which the CAPD library is being developped,
but not on all well tested, are listed below.
<ul>
<li>hardware platforms:
  <ul><li>PC with any Pentium-compatible processor</li>
  <li>SUN Sparc station</li>
<!--  <li>any computer whose processor's floating-point arithmetic
  complies with the IEEE-754 standard (in preparation)</li> -->
  </ul></li>
<li>operating systems:
  <ul><li>virtually any flavor of Linux/Unix</li>
  <li>Windows 95 or newer</li>
  </ul></li>
<li>compilers:
  <ul><li>GNU C++ 3.4.x or newer, including the MinGW port for Windows</li>
<!--  <li>Borland C++ Builder X for Windows</li> -->
<!--  <li>Microsoft Visual C++ .NET (in preparation)</li> -->
<!--  <li>any native C++ compiler (in preparation)</li> -->
  </ul></li>
<li>additional software:
  <ul><li>GNU Make</li>
<!--  <li>any other Make (in preparation)</li> -->
  <li>Perl (only necessary in Windows - this is a temporary solution)</li>
  </ul></li>
</ul>
</p>

<p>The system configurations in which the CAPD library
is being developped, and therefore properly tested, are as follows:
<ul>
<li>SONY VAIO S460/B notebook with the Intel processor,
Windows XP Home Edition, wxDev-Cpp (including MinGW GNU C++ 3.4.2
and wxWidgets 2.6), GNU Make 3.77, Active Perl 5.8.7</li>
</ul>
</p>

<p>Some other systems not mentioned above
may also be supported without notice.</p>

<hr>

<a name="CompilationInstructions"></a>
<h2>Compilation Instructions</h2>

<p>In order to compile the CAPD library,
one can follow the steps listed below:
<ol>
<li>Make sure the system configuration satisfies the system requirements
listed above.</li>
<li>Download the most recent version of the CAPD library
source code distribution from the CAPD website at
<a href="http://capd.ii.uj.edu.pl/" target="_top">capd.ii.uj.edu.pl</a>.</li>
<li>Unpack the downloaded file into an empty directory.
In Linux/Unix make sure the files are unpacked in the text mode, e.g.,
<tt>unzip -a capd_src.zip</tt></li>
<li>[optional] Compile the <tt>filedeps</tt> utility program:
Enter the <tt>utils/filedeps</tt> subdirectory and type <tt>make</tt>.
The file <tt>makefile</tt> may need some adjustments, depending on
the actual system configuration.</li>
<li>Enter the <tt>make</tt> subdirectory of the CAPD package.</li>
<li>Type <tt>make target=TARGET</tt>, where <tt>TARGET</tt>
is the name of one of the configuration files in the <tt>config</tt>
subdirectory (these files are described in details in the
<a href="#ConfigurationFiles">Configuration Files</a> section).
<br>Note: On some systems one must type <tt>gmake</tt>
instead of <tt>make</tt> in order to run GNU make.
</ol>
</p>

<p>Since the number of library modules and related programs is quite large,
be prepared for the compilation to take several minutes.</p>

<hr>

<a name="DirectoryLayout"></a>
<h2>Directory Layout</h2>

<p>The files contained in the source code distribution of the CAPD library
are split among the following subdirectories:
<ul>
<li><b>include</b> - header files, grouped in subdirectories by module</li>
<li><b>src</b> - source code, grouped in subdirectories by module</li>
<li><b>doc</b> - documentation in various formats</li>
<li><b>examples</b> - example programs which illustrate how to use the library;
each group of programs is contained in a separate subdirectory</li>
<li><b>programs</b> - utility programs to be compiled with the library;
they allow one to use some of the library features without the need
to write programs oneself</li>
<li><b>tests</b> - test programs which verify the library for errors;
mainly used by the developers</li>
<li><b>utils</b> - various utility files that support the development
and compilation of the library</li>
<li><b>make</b> - makefiles and supporting files for the automatic
compilation of the library and programs based on it</li>
<li><b>bin</b> - compiled binary programs; initially empty</li>
<li><b>lib</b> - compiled libraries; initially empty</li>
<li><b>obj</b> - compiled object files; initially empty</li>
<li><b>private</b> - user's programs that use the library;
not inlcuded in the source code distribution</li>
</ul>
If any of the directories <tt>bin</tt>, <tt>lib</tt>, <tt>obj</tt>
do not exist, they are created automatically. Note that the compiled
library source files are placed in subdirectories of the <tt>obj</tt>
directory (these subdirectories are also created automatically if necessary).
</p>

<p>Important note: Since all the object files of the programs
are stored in one directory, their names must be mutually different,
even if they belong to different programs linked with the library.</p>

<p>Hint: It is possible to change the location where the results
of compilation are stored. For this purpose it is enough to add
the definitions of the <tt>BIN=</tt>, <tt>LIB=</tt> and <tt>OBJ=</tt>
variables in the configuration file(s) found in the <tt>config</tt>
subdirectory. See <tt>make/makedirs</tt> for the default values
of these variables.</p>

<hr>

<a name="LibraryModules"></a>
<h2>Library Modules</h2>

<p>The source code of the CAPD library is grouped into modules
which contain sets of header files and other source code files.
Each module has its own subdirectory in the <tt>src</tt> directory
and the name of this subdirectory is the name of the module.
All the <tt>cpp</tt> files contained there are compiled into the
corresponding module library called <tt>libcapd<i>module</i></tt>,
and all the <tt>cpp</tt> files from all the modules are also gathered
in the library file <tt>libcapd</tt>.
The header files of the module are located in the module's subdirectory
of the <tt>include</tt> directory.</p>

<p>The following modules are currently available in the CAPD library:
<ul>
<li><b>krak</b> - a simple to use graphics user interface</li>
<li><b>interval</b> - rigorous interval arithmetic</li>
<li><b>vectalg</b> - vector algebra routines</li>
<li><b>map</b> - maps and their derivatives</li>
<li><b>dynsys</b> - dynamical systems</li>
<li><b>dynset</b> - sets in the phase space of a dynamical system</li>
<li><b>covrel</b> - covering relations and h-sets</li>
<li><b>homology</b> - homology computation and related procedures</li>
</ul>
Some other sub-packages of source code consist only of header files,
and therefore they don't form library packages. They can be used
in one's programs by #including appropriate header files.
These packages are:
<ul>
<li><b>capd</b> - common basic header files, mainly configuration
or utility functions</li>
<li><b>poincare</b> - Poincar&eacute; map computation routines</li>
</ul>
</p>


<p>Note that the above list of modules may change without notice,
as the CAPD library is in continuous development.</p>

<hr>

<a name="MakeFiles"></a>
<h2>Make Files</h2>

<p>The following files, all located in the <tt>make</tt> directory,
are used to automatically compile the CAPD library and dependent programs:
<ul>
<li><b>makefile</b> - defines what to compile</li>
<li><b>makecfg</b> - sets the default target configuration</li>
<li><b>makedirs</b> - defines various directories relatively to HOME</li>
<li><b>makemain</b> - defines how to compile one library module</li>
<li><b>makeprog</b> - defines how to compile one set of programs
which use the library</li>
<li><b>config/*</b> - system-dependent configurations</li>
<li><b>auto_dep/*</b> - automatically generated file dependencies</li>
</ul>
</p>

<p>Instead of compiling the entire CAPD library with all the programs,
one can call <tt>make</tt> with arguments listed below for selective
compilation, or other actions related to the compiled files:
<ul>
<li><b>module_name</b> - compile the selected module library</li>
<li><b>program_group</b> - compile and link the selected program group</li>
<li><b>objects</b> - compile all the object files from all the library
modules, and also create module libraries</li>
<li><b>examples</b> - compile and link all the programs located in the
<tt>examples</tt> directory</li>
<li><b>tests</b> - compile and link all the programs located in the
<tt>tests</tt> directory</li>
<li><b>programs</b> - compile and link all the programs located in the
<tt>programs</tt> directory</li>
<li><b>private</b> - compile and link all the programs located in the
<tt>private</tt> directory</li>
<li><b>all</b> - all the above (default)</li>
<li><b>cleandeps</b> - delete all the automatically generated
dependency files</li>
<li><b>cleanobj</b> - delete all the object files</li>
<li><b>cleanlib</b> - delete all the library files</li>
<li><b>cleanexe</b> - delete all the executable files</li>
<li><b>clean</b> - both <tt>cleanobj</tt> and <tt>cleanlib</tt></li>
<li><b>purge</b> - <tt>cleanobj</tt>, <tt>cleanlib</tt>
and <tt>cleanexe</tt></li>
</ul>
Since different target systems may imply different extensions
of object files or executable files, the option <tt>target=TARGET</tt>
must be used each time, even with arguments like <tt>clean</tt>.</p>

<p>Most of the files in the <tt>make</tt> directory are well commented.
Reading them may give insight into more configuration possibilities.</p>

<hr>

<a name="ConfigurationFiles"></a>
<h2>Configuration Files</h2>

<p>Configuration files in the <tt>make/config</tt> directory
define various system-dependent aspects of compilation.
The following files are supplied in the CAPD source code distribution:
<ul>
<li><b>X11</b>, <b>unx</b> - GNU C++ on a typical Linux/Unix
with the X11 graphics library</li>
<li><b>X11-gmp</b> - a modification of <tt>X11</tt> that uses
the multi-precision interval arithmetic (requires the GMP and MPFR libraries,
normally available in most Linux distributions)</li>
<li><b>mac</b> - a modification of the <tt>unx</tt> configuration file
for Mac</li>
<li><b>gcc336</b> - a modification of the <tt>unx</tt> configuration file
to be used for GNU C++ 3.3.6 (should also work fine for newer versions
of the GNU C++ compiler prior to 3.4.2 or even 4.0)</li>
<li><b>win</b> - MinGW GNU C++ in Windows</li>
<li><b>bcc</b> - Borland C++ Builder X in Windows (no longer supported
due to problems with templates)</li>
<li><b>wxDLL</b>, <b>wxMSW</b> - GNU C++ in Windows
with the <a href="http://www.wxwindows.org" target="_top">wxWidgets</a>
GUI library compiled as DLLs or linked statically</li>
<li><b>wxDEV</b> - GNU C++ in Windows with the wxWidgets library,
as configured in the <a href="http://wxdsgn.sourceforge.net/"
target="top">wxDEV-C++ package</a></li>
<li><b>wx</b> - GNU C++ in Linux with the
<a href="http://www.wxwindows.org" target="_top">wxWidgets</a> library</li>
<li><b>dev4980</b> - MinGW GNU C++ in Windows, as packaged
in the Dev-C++ 4.9.8.0 distribution (deprecated)</li>
</ul>
</p>

<p>The variables defined in each configuration file contained
in the <tt>make/config</tt> directory are described below.
Some example settings are quoted in parentheses for clarity.
<ul>
<li><b>COMPILE</b> - the command used to compile the <tt>.cpp</tt>
source code files (<tt>g++ -O2 -ansi -pedantic -Wall</tt>)</li>
<li><b>LINK</b> - the command to link console programs
(<tt>g++ -s</tt>)</li>
<li><b>LINKGUI</b> - the command to link GUI programs
(<tt>g++ -mwindows -s</tt>)</li>
<li><b>MAKELIB</b> - the command to create a library file
from object files (<tt>ar cru</tt>)</li>
<li><b>IDXLIB</b> - the command to add an index to a library
(<tt>ranlib</tt>)</li>
<li><b>REMOVE</b> - the command to delete files (<tt>rm</tt>)</li>
<li><b>SYSLIB</b> - system libraries to link console applications with
(<tt>-lwsock32</tt> or <tt>-lpthread</tt>)</li>
<li><b>SYSLIBG</b> - system libraries to link GUI applications with
(<tt>-L/usr/X11R6/lib/ -lX11 -lGL -lXpm -lpthread</tt>)</li>
<li><b>SYSINCL</b> - switches to include all the necessary
header files (<tt>-Ic:/dev-cpp/include</tt>)</li>
<li><b>EXE</b> - the extension of the executable programs (<tt>.exe</tt>)</li>
<li><b>LIBEXT</b> - the extension of the library files
(<tt>.a</tt> or <tt>.lib</tt>)</li>
<li><b>OBJEXT</b> - the extension of the object files
(<tt>.o</tt> or <tt>.obj</tt>)</li>
</ul>
Please, consult the configuration files supplied with the CAPD library
for more information.
</p>

<hr>

<a name="ProgramsthatUsetheLibrary"></a>
<h2>Programs that Use the Library</h2>

<p>Groups of programs that use the CAPD library are located in one of the
followind directories: <tt>examples</tt>, <tt>tests</tt>, <tt>programs</tt>,
<tt>private</tt>. The latter directory is not included in the source code
distribution, because it is supposed to keep the user's own programs
which must be compiled with the CAPD library.</p>

<p>Each group of programs is gathered in a subdirectory of one of the
directories mentioned above and is supplied with <tt>makefile</tt>.
This file defines the following variables (space-separated lists):
<ul>
<li><b>PROGS</b> - <tt>cpp</tt> files to be compiled as programs</li>
<li><b>OTHERS</b> - <tt>cpp</tt> files which give rise to object files
to be linked with the programs</li>
<li><b>LIBRARY</b> - the CAPD library modules with which the programs should
be linked (the entire CAPD library is used if this list is empty)</li>
<li><b>GUI</b> - defined as 0 if the programs are console applications
or 1 if they are GUI applications</li>
</ul>
The following variables can additionally be defined in <tt>makefile</tt>
to override or modify the settings assumed in <tt>make/makeprog</tt>
and <tt>make/makedirs</tt>:
<ul>
<li><b>SRC</b> - the directory in which the source files of the program group
are located if different from the program group's directory</li>
<li><b>INC</b> - directories that should be added to the search path
for header files instead of the program group's directory</li>
<li><b>OBJ</b> - the directory to put the object files in</li>
<li><b>BIN</b> - the directory to save the binary (executable) programs to</li>
</ul>
The last line in each <tt>makefile</tt> includes the file
<tt>make/makeprog</tt> from the main CAPD directory.
</p>

<p>Since the directory <tt>include</tt> alone is added to the compiler's
search path for <tt>#include</tt>'d files, in the source code of the
programs it is necessary to specify each module subdirectory explicitly.</p>

<p>The successful compilation of each progrm group requires that the
corresponding libraries are compiled first. Moreover, the file
<tt>makedeps</tt> is also necessary; it is generated and updated
automatically by the program <tt>filedeps</tt> and it is silently skipped
if the program <tt>bin/filedeps</tt> does not exist.
The source code of the <tt>filedeps</tt> program with a corresponding
<tt>makefile</tt> is contained in the <tt>utils/filedeps</tt> directory
of the CAPD source code distribution and may be compiled by simply invoking
the <tt>make</tt> command in that directory.</p>

<p>Note that due to the construction of the makefiles supplied with the
CAPD library, the names of program groups must be mutually different,
and also different from the module names.</p>

<hr>

<a name="HowtoCompileaProgramthatUsestheLibrary"></a>
<h2>How to Compile a Program that Uses the Library</h2>

<p>While compiling a program that uses the CAPD library,
it is necessary to add the <tt>include</tt> directory to the
path at which the C++ compiler searches for files included with the
<tt>#include</tt> directive. Moreover, it is necessary to link
such a program with an appropriate library file, <tt>libcapd.a</tt>
for instance. In order to achieve this with least effort, two solutions
are proposed below.</p>

<h3>1. The Global Solution</h3>

<p>After the CAPD library has been successfully compiled, one can install
it in the system by copying the contents of the <tt>include</tt> directory
to the system compiler's <tt>include</tt> directory, and the contents
of the <tt>lib</tt> directory to the directory in which the system
compiler's library files are located.</p>

<p>While linking programs that use the CAPD library, one must add a specific
argument to the compiler command line to link these programs with the CAPD
library (<tt>-l libcapd</tt> for GNU C++).
Note that in some cases other libraries must be linked with as well;
see the <tt>SYSLIB</tt> and <tt>SYSLIBG</tt> variables in the corresponding
file in the <tt>make/config</tt> directory for a hint.</p>

<h3>2. The Local Solution</h3>

<p>If one does not want to interfere the system C++ compiler,
a convenient solution for the automated compilation of the user's programs
is already built in the CAPD library makefiles.
In order to use this solution, the user should create the subdirectory
<tt>private</tt> in the main CAPD directory, and put groups of programs
in its subdirectories (e.g., <tt>private/lorenz3d</tt>).
Note that the source code files in each group of programs should consist
of files with the <tt>.cpp</tt> extension, and, optionally, some other
files as well (e.g., header files).</p>

<p>The user must create <tt>makefile</tt> and list all the <tt>.cpp</tt>
files which give rise to programs (i.e., contain the <tt>main</tt> function)
in the <tt>PROGS</tt> variable, and all the other <tt>.cpp</tt> files
with which these programs should be linked&mdash;in the <tt>OTHERS</tt>
variable. The last line of <tt>makefile</tt> should include
<tt>../../make/makeprog</tt>.
Some other variables may also be defined there, and they are described
in the previous section. Please, see the makefiles contained in the
<tt>examples</tt>, <tt>tests</tt> and <tt>programs</tt> subdirectories
for specific examples.</p>

<p>Now it is enough to type <tt>make</tt> (or <tt>make target=TARGET</tt>)
in the program group's subdirectory to compile these programs
and link them with the CAPD library. The program groups located in the
<tt>private</tt> directory are also automatically compiled if the entire
CAPD library is compiled with all its components by typing
<tt>make</tt> (or <tt>make target=TARGET</tt>) in the <tt>make</tt>
directory of CAPD.</p>

<p>Note that in order to be able to use this way of automated compilation
of one's programs, one must first compile the <tt>filedeps</tt> program
which generates a file <tt>makedeps</tt> for each group of programs.
The source code of the <tt>filedeps</tt> program with a corresponding
<tt>makefile</tt> is located in the <tt>utils/filedeps</tt> subdirectory
of the CAPD library source code distribution.</p>

<p>Another important requirement is that the names of the user's
<tt>.cpp</tt> files are different from all the <tt>.cpp</tt> files
found in the library modules and all the other groups of programs.
A simple Perl script <tt>utils/checknames.pl</tt> can be used to verify
this uniqueness-of-filenames property in a convenient and quick way.</p>

<hr>

<p><font size="1">All trademarks, registered trademarks
or brand names are property of the respective holders and used in this
document for descriptive purposes only.
Copyright &copy; 2005 by the CAPD Group. All rights reserved.</font>
</p>

</body>
</html>
